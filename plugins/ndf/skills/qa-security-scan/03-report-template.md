# セキュリティレポートテンプレート

## 使用方法

このテンプレートをコピーして、セキュリティスキャン結果を報告してください。

---

# セキュリティスキャンレポート - [アプリケーション名]

## エグゼクティブサマリー

- **スキャン日**: YYYY-MM-DD
- **スキャン範囲**: [対象範囲の説明]
- **重大な脆弱性**: X件
- **警告**: Y件
- **情報**: Z件

## 重大な脆弱性 (Critical/High)

### 1. [脆弱性名]

- **場所**: [ファイルパス/エンドポイント]
- **リスクレベル**: 高
- **説明**: [脆弱性の詳細説明]
- **影響**: [悪用された場合の影響]
- **修正方法**:
  ```javascript
  // 修正前
  [問題のあるコード]

  // 修正後
  [修正されたコード]
  ```
- **優先度**: 最高（即座に修正）

### 2. [脆弱性名]

[同様のフォーマットで記載]

## 警告 (Medium)

### 3. [脆弱性名]

- **場所**: [ファイルパス/エンドポイント]
- **リスクレベル**: 中
- **説明**: [脆弱性の詳細説明]
- **修正方法**: [修正方法の説明]

## 情報 (Low/Info)

### 4. [項目名]

- **場所**: [ファイルパス/エンドポイント]
- **説明**: [詳細説明]
- **推奨事項**: [推奨される対応]

## 推奨事項

1. **即座に修正**: 重大な脆弱性X件
2. **1週間以内に修正**: 警告Y件
3. **セキュリティヘッダー追加**: helmet.js 使用
4. **依存ライブラリの更新**: npm audit で検出された脆弱性
5. **定期的なセキュリティスキャン**: 月1回の実施

## 次のステップ

1. [ ] 重大な脆弱性の修正
2. [ ] 修正後の再スキャン
3. [ ] ペネトレーションテストの実施
4. [ ] セキュリティ監視の強化

---

## レポート作成のポイント

### リスクレベルの判断基準

| レベル | 基準 |
|--------|------|
| Critical | リモートコード実行、認証バイパス、データ全体へのアクセス |
| High | SQLインジェクション、XSS（保存型）、権限昇格 |
| Medium | XSS（反射型）、CSRF、情報漏洩（限定的） |
| Low | セキュリティヘッダー不足、詳細なエラーメッセージ |
| Info | ベストプラクティスからの逸脱 |

### 修正優先度

1. **即座に**: Critical/High（本番環境に影響）
2. **1週間以内**: Medium（悪用の可能性あり）
3. **次回リリース**: Low/Info（改善推奨）

## Codex CLI MCP統合

```javascript
// Codex でセキュリティスキャン実行
const result = await codex({
  prompt: `
    以下のコードをセキュリティスキャンしてください:
    - OWASP Top 10 の脆弱性
    - 認証・認可の問題
    - 機密情報の露出

    ${codeContent}
  `,
  'approval-policy': 'on-request'
});
```
