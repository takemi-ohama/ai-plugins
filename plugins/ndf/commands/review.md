# PRレビューコマンド

直前PRを専門家としてレビュー。

## 実行
- 問題点・改善点を指摘→「Request Changes」
- 指摘なし→「Approve」

## 観点
コード品質・セキュリティ・可読性・保守性・テストカバレッジ

## 作業完了報告（必須）

作業完了時は以下の情報を必ず報告すること：

### 報告テンプレート

```
PRレビューが完了しました。

## レビューサマリー

| 項目 | 値 |
|------|-----|
| PRタイトル | [PRのタイトル] |
| レビュー結果 | ✅ Approve / ⚠️ Request Changes / 💬 Comment |
| レビュー日時 | YYYY-MM-DD HH:MM:SS |
| 変更ファイル数 | N個 |
| 変更行数 | +追加行, -削除行 |
| 変更の種類 | 新機能 / バグフィックス / リファクタリング / ドキュメント |

## レビュー結果の詳細

### ✅ 良い点
1. [良い点1]
2. [良い点2]
3. [良い点3]

### ⚠️ 指摘事項（Request Changesの場合）

| # | カテゴリ | 重要度 | ファイル | 指摘内容 | 推奨対応 |
|---|----------|--------|----------|----------|----------|
| 1 | [カテゴリ] | Critical/High/Medium/Low | `path/to/file.js:行番号` | [指摘内容] | [対応方法] |
| 2 | [カテゴリ] | Critical/High/Medium/Low | `path/to/file.js:行番号` | [指摘内容] | [対応方法] |

### 💡 改善提案（オプション）
1. [改善提案1]
2. [改善提案2]

## レビュー観点別評価

| 観点 | 評価 | コメント |
|------|------|----------|
| コード品質 | ⭐⭐⭐⭐⭐ | [コメント] |
| セキュリティ | ⭐⭐⭐⭐☆ | [コメント] |
| 可読性 | ⭐⭐⭐⭐⭐ | [コメント] |
| 保守性 | ⭐⭐⭐⭐☆ | [コメント] |
| テストカバレッジ | ⭐⭐⭐☆☆ | [コメント] |

## 統計

| 項目 | 値 |
|------|-----|
| 指摘した問題数 | N件 |
| ├─ Critical | X件 |
| ├─ High | Y件 |
| ├─ Medium | Z件 |
| └─ Low | W件 |
| コメント数 | M件 |
| レビュー時間 | 約N分 |

## 次のアクション

| タスク | 状態 |
|--------|------|
| 開発者が指摘事項に対応 | ⏳ 待機中 |
| 対応完了後に再レビュー | ⏳ 待機中 |
| マージ承認 | ⏳ 待機中 |

---

## 📎 リンク

**PR URL**: https://github.com/owner/repo/pull/123
```

### 報告例（Request Changesの場合）

```
PRレビューが完了しました。

## レビューサマリー

| 項目 | 値 |
|------|-----|
| PRタイトル | feat: affaan-mプラグインのフックスクリプトをClaude Code仕様に実装 |
| レビュー結果 | ⚠️ Request Changes |
| レビュー日時 | 2026-01-31 07:00:00 |
| 変更ファイル数 | 7個 |
| 変更行数 | +275, -497 |
| 変更の種類 | 新機能（フックスクリプトの実装） |

## レビュー結果の詳細

### ✅ 良い点
1. Claude Code Hooks仕様に完全準拠した実装
2. コード削減（497行 → 275行、45%削減）
3. 実機能を持つ3つのスクリプトが正しく動作

### ⚠️ 指摘事項

| # | カテゴリ | 重要度 | ファイル | 指摘内容 | 推奨対応 |
|---|----------|--------|----------|----------|----------|
| 1 | セキュリティ | Critical | `secret-scan.js:15` | AWS_SECRET_ACCESS_KEYの正規表現が広すぎる | /iフラグを追加して厳密化 |
| 2 | ロジックエラー | High | `secret-scan.js:44` | バイナリファイルのハンドリングがない | バイナリ拡張子のフィルタリング追加 |
| 3 | ロジックエラー | High | `typescript-check.js:44` | TypeScriptインストール確認がない | npx tsc --versionで事前確認 |
| 4 | ロジックエラー | Medium | `detect-package-manager.js:39` | 複数lockファイルの競合処理 | 最新ファイルを優先する判定追加 |

### 💡 改善提案
1. エラーメッセージをより詳細に記述
2. テストケースの追加検討

## レビュー観点別評価

| 観点 | 評価 | コメント |
|------|------|----------|
| コード品質 | ⭐⭐⭐⭐☆ | 概ね良好だが、エラーハンドリングに改善余地 |
| セキュリティ | ⭐⭐⭐☆☆ | 正規表現の改善が必要 |
| 可読性 | ⭐⭐⭐⭐⭐ | コードは明確で理解しやすい |
| 保守性 | ⭐⭐⭐⭐⭐ | シンプルな構造で保守しやすい |
| テストカバレッジ | ⭐⭐⭐☆☆ | 手動テストのみ、自動テスト不足 |

## 統計

| 項目 | 値 |
|------|-----|
| 指摘した問題数 | 4件 |
| ├─ Critical | 1件 |
| ├─ High | 2件 |
| ├─ Medium | 1件 |
| └─ Low | 0件 |
| コメント数 | 4件 |
| レビュー時間 | 約15分 |

## 次のアクション

| タスク | 状態 |
|--------|------|
| 開発者が指摘事項に対応（4件） | ⏳ 待機中 |
| 対応完了後に再レビュー | ⏳ 待機中 |
| Critical/High問題解決後にマージ承認 | ⏳ 待機中 |

---

## 📎 リンク

**PR URL**: https://github.com/takemi-ohama/ai-plugins/pull/13
```

### 報告例（Approveの場合）

```
PRレビューが完了しました。

## レビューサマリー

| 項目 | 値 |
|------|-----|
| PRタイトル | feat: affaan-mプラグインのフックスクリプトをClaude Code仕様に実装 |
| レビュー結果 | ✅ Approve |
| レビュー日時 | 2026-01-31 10:00:00 |
| 変更ファイル数 | 7個 |
| 変更行数 | +275, -497 |
| 変更の種類 | 新機能（フックスクリプトの実装） |

## レビュー結果の詳細

### ✅ 良い点
1. Claude Code Hooks仕様に完全準拠
2. セキュリティ対策が適切（シークレットスキャン、TypeScript型チェック）
3. コード削減により保守性向上（45%削減）
4. エラーハンドリングが適切
5. JSON出力形式が仕様に準拠

### 💡 改善提案（マージ後でも可）
1. 自動テストの追加を検討
2. CI/CDパイプラインの統合

## レビュー観点別評価

| 観点 | 評価 | コメント |
|------|------|----------|
| コード品質 | ⭐⭐⭐⭐⭐ | 高品質なコード |
| セキュリティ | ⭐⭐⭐⭐⭐ | セキュリティ対策が適切 |
| 可読性 | ⭐⭐⭐⭐⭐ | 非常に読みやすい |
| 保守性 | ⭐⭐⭐⭐⭐ | シンプルで保守しやすい |
| テストカバレッジ | ⭐⭐⭐⭐☆ | 手動テストは十分 |

## 統計

| 項目 | 値 |
|------|-----|
| 指摘した問題数 | 0件 |
| コメント数 | 5件（Good pointsのみ） |
| レビュー時間 | 約10分 |

## 次のアクション

| タスク | 状態 |
|--------|------|
| マージ承認 | ✅ 完了 |
| マージ実行 | 🚀 実行可能 |

---

## 📎 リンク

**PR URL**: https://github.com/takemi-ohama/ai-plugins/pull/13
```

