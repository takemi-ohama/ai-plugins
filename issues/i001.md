# NDFプラグインと公式プラグインの機能重複調査・削除計画

**作成日**: 2026-01-03
**ステータス**: 調査完了・削除計画策定済み

## 1. 調査概要

### 調査対象
- **anthropics/claude-plugins-official**: https://github.com/anthropics/claude-plugins-official
- **NDFプラグイン**: `/home/ubuntu/work/claude-plugins/plugins/ndf/`

### 調査結果サマリー

anthropics/claude-plugins-officialには以下のプラグインが含まれています：

**公式プラグイン (plugins/)**: 23個
- LSP系プラグイン (10個): clangd, csharp, gopls, jdtls, lua, php, pyright, rust-analyzer, swift, typescript
- 開発ワークフロー系 (3個): code-review, commit-commands, pr-review-toolkit
- 開発支援系 (10個): agent-sdk-dev, example-plugin, explanatory-output-style, feature-dev, frontend-design, hookify, learning-output-style, plugin-dev, ralph-wiggum, security-guidance

**外部プラグイン (external_plugins/)**: 13個
- MCP統合系: github, context7, serena
- プロジェクト管理: asana, linear, gitlab, slack
- 開発ツール: firebase, greptile, laravel-boost, playwright, stripe, supabase

## 2. 重複機能の詳細分析

### 2.1. MCPサーバーの重複 ⚠️ **重大な重複**

NDFプラグインは`.mcp.json`で以下のMCPサーバーを統合しています：

| MCPサーバー | NDFでの状態 | 公式での提供 | 重複度 |
|------------|-----------|------------|-------|
| **github** | 有効 (Docker) | external_plugins/github | **100%重複** |
| **context7** | 有効 (HTTP) | external_plugins/context7 | **100%重複** |
| **serena** | 有効 (uvx) | external_plugins/serena | **100%重複** |
| notion | 無効 | - | 重複なし |
| awslabs.aws-documentation-mcp-server | 無効 | - | 重複なし |
| mcp-server-bigquery | 無効 | - | 重複なし |
| dbhub | 無効 | - | 重複なし |
| chrome-devtools-mcp | 有効 | - | 重複なし |
| codex | 有効 | - | 重複なし |
| claude-code | 無効 | - | 重複なし |

**結論**: **3つのMCPサーバー (github, context7, serena) が100%重複**

### 2.2. スラッシュコマンドの重複 🔶 **部分的重複**

#### NDFプラグインのコマンド (6個)
1. `/ndf:serena` - 開発記憶の記録
2. `/ndf:pr` - PR作成
3. `/ndf:fix` - PR修正対応
4. `/ndf:review` - PRレビュー
5. `/ndf:merged` - マージ後クリーンアップ
6. `/ndf:clean` - ブランチクリーンアップ

#### 公式プラグインのコマンド

**commit-commands プラグイン**:
- Git commit/push/PR作成のワークフローコマンド
- NDFの`/ndf:pr`と**機能的に重複**の可能性あり

**code-review プラグイン**:
- 自動コードレビュー機能
- NDFの`/ndf:review`と**機能的に重複**の可能性あり

**pr-review-toolkit プラグイン**:
- 包括的なPRレビューエージェント
- NDFの`/ndf:review`と**機能的に重複**の可能性あり

**結論**: **コマンド名は異なるが、機能的には重複あり**

### 2.3. サブエージェントの重複 ✅ **重複なし**

#### NDFプラグインのエージェント (6個)
1. **director** - タスク統括と調整
2. **data-analyst** - データ分析とSQL操作
3. **corder** - 高品質コード生成
4. **researcher** - 情報収集と分析
5. **scanner** - ファイル読み取り
6. **qa** - 品質管理とテスト

#### 公式プラグインのエージェント

**pr-review-toolkit プラグイン**:
- comments, tests, error-handling, type-design, code-quality, code-simplification
- NDFの**qa**エージェントと**機能的に類似**

**結論**: **名前は異なるが、qaエージェントとpr-review-toolkitは機能的に類似**

### 2.4. Claude Code Skillsの重複 ✅ **重複なし**

NDFプラグインは10個のClaude Code Skillsを独自に提供しており、公式プラグインには同等の機能はありません。

**結論**: **Skillsは完全にNDF独自機能**

## 3. 削除対象の特定

### 3.1. 削除すべきもの（高優先度）

#### A. MCPサーバー統合の削除 ⚠️ **最優先**

**対象ファイル**: `/home/ubuntu/work/claude-plugins/plugins/ndf/.mcp.json`

**削除対象セクション**:
```json
// 完全削除
"github": { ... }
"context7": { ... }
"serena": { ... }
```

**理由**:
- これら3つのMCPサーバーは公式external_pluginsで提供されている
- ユーザーは公式プラグインを個別にインストール可能
- NDFで統合する必要性なし
- メンテナンス負担の軽減

**影響範囲**:
- NDFプラグインのREADME.mdの「MCP統合」セクション更新必要
- CLAUDE.ndf.mdの「Available MCP Tools」セクション更新必要
- Serenaメモリー (`plugin-ndf.md`) の更新必要
- plugin.jsonのバージョンインクリメント (1.2.1 → 1.3.0 or 2.0.0)

### 3.2. 検討すべきもの（中優先度）

#### B. スラッシュコマンドの整理 🔶

**現状**:
- NDFプラグインは6個のワークフローコマンドを提供
- 公式には`commit-commands`, `code-review`, `pr-review-toolkit`が存在
- 機能的に重複する可能性あり

**推奨アクション**:
1. **詳細調査を実施** - 公式プラグインのコマンド内容を精査
2. **差別化要素を明確化** - NDFコマンドの独自価値を確認
3. **統合または削除を判断** - ユーザー体験を最優先

**注意**:
- ユーザーがすでにNDFコマンドに慣れている場合、削除は混乱を招く
- 公式コマンドとNDFコマンドの併用も可能
- 段階的な移行計画が必要

#### C. qaエージェントとpr-review-toolkitの関係 🔶

**現状**:
- NDFの`qa`エージェントはコード品質・セキュリティ・パフォーマンステストを担当
- 公式の`pr-review-toolkit`は包括的なPRレビュー機能を提供
- 機能的に類似

**推奨アクション**:
1. **詳細調査を実施** - pr-review-toolkitの機能範囲を確認
2. **補完関係の確認** - NDFのqaエージェントが提供する独自価値を評価
3. **統合または共存を判断** - ユーザーニーズに基づく

### 3.3. 保持すべきもの（削除不要）

#### D. 独自のサブエージェント ✅

以下のエージェントは完全にNDF独自機能として保持：
- **director** - タスク統括（公式にない）
- **data-analyst** - BigQueryやDBHub連携（公式にない）
- **corder** - Codex統合のコーディング支援（公式にない）
- **researcher** - AWS Docs/Chrome DevTools連携（公式にない）
- **scanner** - PDF/Excel読み取り（公式にない）

#### E. Claude Code Skills ✅

10個のSkillsはすべてNDF独自機能として保持：
- director-project-planning
- data-analyst-sql-optimization
- data-analyst-export
- corder-code-templates
- corder-test-generation
- researcher-report-templates
- scanner-pdf-analysis
- scanner-excel-extraction
- qa-code-review-checklist
- qa-security-scan

#### F. 独自のMCPサーバー ✅

以下のMCPサーバーは公式に存在しないため保持：
- notion (現在無効)
- awslabs.aws-documentation-mcp-server (現在無効)
- mcp-server-bigquery (現在無効)
- dbhub (現在無効)
- chrome-devtools-mcp (有効)
- codex (有効)
- claude-code (現在無効)

#### G. Slackフック・通知機能 ✅

以下は完全にNDF独自機能として保持：
- `hooks/hooks.json`
- `scripts/slack-notify.js`
- Stop hookによる自動Slack通知

## 4. 削除手順の詳細計画

### フェーズ1: MCPサーバー統合の削除（最優先）

#### ステップ1: .mcp.jsonの編集

**対象ファイル**: `plugins/ndf/.mcp.json`

**変更内容**:
```json
{
  "mcpServers": {
    // ❌ 削除: "github": { ... }
    // ❌ 削除: "context7": { ... }
    // ❌ 削除: "serena": { ... }

    // ✅ 保持
    "notion": { ... },
    "awslabs.aws-documentation-mcp-server": { ... },
    "mcp-server-bigquery": { ... },
    "dbhub": { ... },
    "chrome-devtools-mcp": { ... },
    "codex": { ... },
    "claude-code": { ... }
  }
}
```

#### ステップ2: README.mdの更新

**対象ファイル**: `plugins/ndf/README.md`

**更新セクション**:
- 「MCP統合」セクション: 10サーバー → 7サーバーに変更
- 削除したMCPサーバーの説明を削除
- 公式external_pluginsへの参照を追加

**追加テキスト例**:
```markdown
## 公式プラグインとの連携

以下のMCPサーバーは公式external_pluginsで提供されています。
必要に応じて個別にインストールしてください：

- **GitHub MCP**: `/plugin install github@claude-plugin-directory`
- **Context7 MCP**: `/plugin install context7@claude-plugin-directory`
- **Serena MCP**: `/plugin install serena@claude-plugin-directory`
```

#### ステップ3: CLAUDE.ndf.mdの更新

**対象ファイル**: `plugins/ndf/CLAUDE.ndf.md`

**更新セクション**:
- "Available MCP Tools (Reference)" セクション
- 削除したMCPサーバーの説明を削除
- バージョンコメントを更新

```markdown
<!-- VERSION: 3 -->
```

#### ステップ4: Serenaメモリーの更新

**対象ファイル**: Serenaメモリー `plugin-ndf.md`

**更新内容**:
- MCPサーバー数: 10 → 7に変更
- 削除した3つのMCPサーバーの説明を削除
- 公式プラグイン参照を追加

#### ステップ5: plugin.jsonのバージョン更新

**対象ファイル**: `plugins/ndf/.claude-plugin/plugin.json`

**バージョン判断**:
- **MAJOR (2.0.0)**: MCP統合を削除は破壊的変更の可能性あり（推奨）
- **MINOR (1.3.0)**: 後方互換性があると判断した場合

**推奨**: **2.0.0** (破壊的変更として扱う)

**理由**:
- ユーザーがgithub/context7/serena MCPに依存している場合、動作しなくなる
- 明示的なメジャーバージョンアップで変更を周知

```json
{
  "name": "ndf",
  "version": "2.0.0",
  "description": "Integrated plugin with specialized agents, commands, and skills. MCP servers moved to official plugins.",
  ...
}
```

#### ステップ6: テスト

1. **ローカルテスト**:
   ```bash
   /plugin reload ndf
   /help mcp
   ```
   - github, context7, serena MCPが表示されないことを確認

2. **機能テスト**:
   - 残りの7つのMCPサーバーが正常に動作することを確認
   - サブエージェント（director, corder等）が正常に動作することを確認

3. **ドキュメント検証**:
   - README.mdの記載が正確であることを確認
   - CLAUDE.ndf.mdの記載が正確であることを確認

#### ステップ7: コミット・PR作成

**ブランチ名**: `feature/remove-duplicate-mcp-servers`

**コミットメッセージ例**:
```
feat: GitHub/Context7/Serena MCPを公式プラグインに移譲

BREAKING CHANGE: 以下のMCPサーバーをNDFプラグインから削除
- github MCP
- context7 MCP
- serena MCP

これらのMCPサーバーは公式external_pluginsで提供されるため、
必要に応じて個別にインストールしてください：
  /plugin install github@claude-plugin-directory
  /plugin install context7@claude-plugin-directory
  /plugin install serena@claude-plugin-directory

影響:
- .mcp.jsonから3つのMCPサーバー定義を削除
- README.md、CLAUDE.ndf.md、Serenaメモリーを更新
- バージョンを2.0.0にアップグレード

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
```

**PR説明**:
```markdown
## Summary
- NDFプラグインからgithub/context7/serena MCPサーバー統合を削除
- これらのMCPサーバーはanthropics/claude-plugins-officialのexternal_pluginsで提供されているため重複を解消

## Breaking Changes
⚠️ **破壊的変更**: 以下のMCPサーバーがNDFプラグインから削除されます
- GitHub MCP
- Context7 MCP
- Serena MCP

## Migration Guide
ユーザーは以下のコマンドで公式プラグインをインストールできます：
```bash
/plugin install github@claude-plugin-directory
/plugin install context7@claude-plugin-directory
/plugin install serena@claude-plugin-directory
```

## Changes
- 削除: .mcp.json内のgithub/context7/serena MCP定義
- 更新: README.md（MCP統合セクション）
- 更新: CLAUDE.ndf.md（Available MCP Toolsセクション）
- 更新: Serenaメモリー（plugin-ndf.md）
- 更新: plugin.json（バージョン2.0.0）

## Test Plan
- [x] ローカルでNDFプラグインを再読み込み
- [x] 残りの7つのMCPサーバーが正常動作
- [x] サブエージェントが正常動作
- [x] ドキュメントが正確

🤖 Generated with [Claude Code](https://claude.com/claude-code)
```

### フェーズ2: スラッシュコマンドの整理（中優先度）

#### 前提条件
フェーズ1（MCPサーバー削除）完了後に実施

#### ステップ1: 公式プラグインのコマンド詳細調査

**調査対象**:
1. `commit-commands` プラグインのコマンド一覧と機能
2. `code-review` プラグインのコマンド一覧と機能
3. `pr-review-toolkit` プラグインのコマンド一覧と機能

**調査方法**:
- GitHubリポジトリから各プラグインのREADME.mdとcommands/を確認
- 実際にプラグインをインストールして動作確認

#### ステップ2: 重複・差別化要素の評価

**評価基準**:
| 項目 | 評価内容 |
|-----|---------|
| 機能の重複度 | 公式コマンドと完全に重複しているか |
| 独自価値 | NDFコマンドにしかない機能があるか |
| ユーザー体験 | コマンド名・使用方法が直感的か |
| メンテナンス性 | NDFで保持する価値があるか |

#### ステップ3: 削除判断と実施

**判断フロー**:
1. **完全重複かつ独自価値なし** → 削除
2. **部分重複だが独自価値あり** → 保持（ドキュメント強化）
3. **重複なし** → 保持

**削除手順**（削除対象がある場合）:
1. `plugin.json`のcommandsフィールドから削除
2. `commands/`ディレクトリから該当ファイルを削除
3. README.md、CLAUDE.ndf.mdを更新
4. Serenaメモリーを更新
5. plugin.jsonのバージョンをインクリメント (2.0.0 → 2.1.0 or 3.0.0)
6. テスト・コミット・PR作成

### フェーズ3: qaエージェントの評価（低優先度）

#### ステップ1: pr-review-toolkitの機能確認

**調査内容**:
- pr-review-toolkitのエージェント一覧と機能
- NDFのqaエージェントとの機能比較
- 補完関係の評価

#### ステップ2: 統合・共存判断

**判断基準**:
| シナリオ | アクション |
|---------|----------|
| 完全重複 | qaエージェントを削除または統合 |
| 補完関係 | 両方保持、ドキュメントで使い分けを明記 |
| 独自機能多数 | qaエージェント保持 |

## 5. 削除による影響評価

### 5.1. ユーザーへの影響

#### A. MCPサーバー削除 (フェーズ1)

**影響度**: 🔴 **高**

**影響を受けるユーザー**:
- github/context7/serena MCPを使用している全ユーザー

**移行手順**:
1. NDFプラグインを2.0.0にアップグレード
2. 必要なMCPサーバーを個別にインストール
   ```bash
   /plugin install github@claude-plugin-directory
   /plugin install context7@claude-plugin-directory
   /plugin install serena@claude-plugin-directory
   ```

**メリット**:
- 公式プラグインの最新機能を利用可能
- NDFプラグインのメンテナンス負担軽減
- 明確な責任分界点

**デメリット**:
- 移行作業が必要
- インストールコマンドが増える

#### B. スラッシュコマンド削除 (フェーズ2)

**影響度**: 🟡 **中** (削除対象による)

**影響を受けるユーザー**:
- 削除対象コマンドを使用しているユーザー

**移行手順**:
- 公式プラグインの対応コマンドに移行

#### C. qaエージェント削除 (フェーズ3)

**影響度**: 🟡 **中** (削除する場合)

**影響を受けるユーザー**:
- qaエージェントを使用している全ユーザー

**移行手順**:
- pr-review-toolkitプラグインに移行

### 5.2. 技術的影響

**プラグイン構成**:
- ファイル数: 若干減少
- 依存関係: シンプル化
- メンテナンス性: 向上

**互換性**:
- バージョン1.x → 2.x: 破壊的変更あり
- 既存ユーザーへの周知必須

## 6. リスクと対策

### リスク1: ユーザーの混乱

**リスク**: MCPサーバーが突然使えなくなる

**対策**:
- 明確なマイグレーションガイド提供
- README.mdに大きく記載
- BREAKING CHANGEとしてコミットメッセージに明記

### リスク2: 機能劣化の懸念

**リスク**: 公式プラグインがNDFの統合版より使いづらい

**対策**:
- 事前に公式プラグインの動作確認
- 必要に応じてフィードバックをAnthropicに提供

### リスク3: ユーザー離反

**リスク**: 変更が大きすぎてNDFプラグインから離れる

**対策**:
- 段階的な変更（フェーズ1→2→3）
- 各フェーズで十分な周知期間を設ける
- ユーザーフィードバックを収集

## 7. 推奨スケジュール

### 即座に実施（Week 1-2）

✅ **フェーズ1: MCPサーバー削除**
- 最も重複度が高く、明確な削除対象
- 公式プラグインで代替可能
- 即座に実施推奨

### 調査後に判断（Week 3-4）

🔶 **フェーズ2: スラッシュコマンド整理**
- 詳細調査が必要
- ユーザー影響を慎重に評価
- 調査結果に基づいて判断

### 長期的に検討（Month 2-3）

🔶 **フェーズ3: qaエージェント評価**
- 急ぎではない
- pr-review-toolkitの成熟度を見極める
- ユーザーフィードバックを収集してから判断

## 8. 成功基準

### フェーズ1成功基準

- [ ] .mcp.jsonから3つのMCPサーバーが削除されている
- [ ] README.md、CLAUDE.ndf.md、Serenaメモリーが更新されている
- [ ] plugin.jsonが2.0.0にアップグレードされている
- [ ] ローカルテストがすべてパスしている
- [ ] PRがマージされている
- [ ] ユーザーへの周知が完了している

### フェーズ2成功基準

- [ ] 公式プラグインのコマンド詳細調査が完了している
- [ ] 削除判断が明確になっている
- [ ] 削除対象がある場合、実施完了している
- [ ] ユーザーへの移行ガイドが提供されている

### フェーズ3成功基準

- [ ] pr-review-toolkitの機能確認が完了している
- [ ] qaエージェントの方向性が決定している
- [ ] 必要に応じて実施完了している

## 9. 次のアクション

### 即座に実施すべきこと

1. **ユーザーに確認**
   - この削除計画に同意するか
   - 特に懸念事項はないか

2. **フェーズ1実施開始**
   - featureブランチ作成
   - .mcp.json編集
   - ドキュメント更新
   - テスト・コミット・PR作成

### 後続タスク

3. **フェーズ2調査開始**
   - 公式プラグインのコマンド詳細調査
   - 削除判断の材料収集

4. **フェーズ3調査開始**
   - pr-review-toolkitの機能確認
   - 長期的な方向性検討

## 10. 参考情報

### 関連リンク

- **anthropics/claude-plugins-official**: https://github.com/anthropics/claude-plugins-official
- **NDFプラグイン**: `/home/ubuntu/work/claude-plugins/plugins/ndf/`
- **Claude Code公式ドキュメント**: https://docs.claude.com/en/docs/claude-code

### 調査で使用したツール

- Serena MCP: プロジェクト構造理解
- GitHub MCP: 公式リポジトリ調査
- Read/Glob/Grep: ファイル内容確認

---

**最終更新**: 2026-01-03
**作成者**: Claude Code (Director Agent)
