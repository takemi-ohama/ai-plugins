# 開発AIエージェント向け指示書

* このドキュメントはClaude Codeなどの開発AIエージェント向けの指示書です。
* チャットで「docs/cmd01.mdのx番を実行してください」と言われたらこのファイルを読み、見出しに書いてある番号の内容を実行してください。
* 頻繁に書き換わるので、指示があるたびに読み込みなおしてください。
* 返答やドキュメントはすべて日本語で。

# 1. Agent SkillとSerena MCP Memoryを効率的に活用するためのSkillとMemory
* 以下のChatGPTが考察したAgent SkillとSerena MCPの使い分けと記憶戦略についてのドキュメントがあります。
    * issues/report03.md
    * issues/report04.md
    * issues/report05.md
* この指針に従ってndfプラグインに記憶のためのカスタムコマンドとSkillを追加してください。
* Serena MCP Meoryへの記憶戦略の書き込みはカスタムコマンドとスキルが担います。
    * PluginにSerena MCP Memoryを反映することができないため

# 2. ndf のMCPサーバ群を変更
* plugins/ndf/CLAUDE.ndf.md
* serena, context7, codexのみを登録してください
* notion, awslabs.aws-docs, bigquery, dbhub, chrome-devtools はndf pluginからは除外し、それぞれをインストールするpluginをこのMarketplace上に作成してください。
* ndfのドキュメントをこの変更に合わせて修正してください。


# 3. python実行時に参照するskill
* plugins/ndf/skills
* python実行時のskillを追加してください。
    * pythonを実行しようとする場合に参照する以下のような内容のskill
    * pythonはpython3, pythonの他、uvでの実行を前提とする環境があることに注意する
    * pythonコードを実行する前に、環境やプロジェクトがどの実行方法を前提としているかを調査すること
    * プロジェクト内にpyproject.tomlや.venvがあればuv環境での実行を優先する
    * README.mdやCLAUDE.mdにpython実行方法についての例があればそれに従う
    * uvを使う場合の事前準備方法を案内

# 4. dockerコンテナアクセス時に参照するskill
* plugins/ndf/skills
* コンテナ(Docker)利用時に参照するskillを追加してください。
    * dockerコマンドやcurl、playwright mcpやchrome dev toolsでコンテナにアクセスする場合に参照する以下のような内容のskill
    * ローカル環境は、開発用コンテナ上で起動された環境である可能性があります。
    * このため、この環境でdockerコンテナを起動すると、DinD、DooDのいずれかの形式で起動される可能性があります
    * DinDとDooDではコンテナへのアクセス方法が異なるので、自身の環境がどういったものかをまず確定する必要があります。
    * DinD環境の場合、localhostで他のコンテナにアクセスできます
    * DooD環境の場合、localhostでは接続できず、dockerコンテナ名でアクセスすることになります
        * curlなどの参考例をつけておいてください
    * また、DooD環境の場合、bind mountはホスト側の環境に接続しようとするため、ローカル環境内にアクセスできません。
        * できるだけcompose.ymlやdocker run時のmountは避け、必要なファイルはDockerfileでCOPYするようにしてください
         * どうしても必要な場合、volumeを作成するなどして必要なファイルをコピーしてから目的のコンテナにmountする必要があります。

# 5. Agent Skill開発のためのベストプラクティスSkill
* Claude CodeのAgent Skillsのベストプラクティスを調査し、Skillとして登録してください
* 特にコンテキスト節約のための多段階読み込みなどに対応した書き方、Toolの登録方法について重点的に調査して盛り込んでください
* plugins/ndf/skills のskillとして登録してください

# 6.　plugins/ndf/skills/skill-development に従ってすべてのスキルをリファクタリング
* plugins/ndf/skills のすべてのスキルを、plugins/ndf/skills/skill-developmentに従って最適化してください

# 7. fix修正
plugins/ndf/commands/fix.md
* ## 実行の4.以降の作業を以下のように追加します。
    * いずれもgithub mcpまたはghコマンドを利用
        * 修正内容について、PRにSummaryコメントを追加
        * 修正内容を指摘したreviewerとcopilotにreviewを再レビューを依頼
        * 対応したコードコメントに個別に返信する
        * 対応が完全に完了したコードコメントは「Resolve Conversation」とする
* 作業完了報告の報告テンプレートが少し量が多いので、内容を減らしてください

# 8. fix時のテンプレート
plugins/ndf/commands/fix.md
* 報告テンプレートを改善します
    * issues/template09.md を参考にPRにのコメントとしてふさわしい形にしてください

# 9. mcpを整理
* ndfからnotion, aws-docs, bigquery, dbhub, chrome-devtools は削除してください。
* これらのツールを個別にインストールするpluginを追加してください。
